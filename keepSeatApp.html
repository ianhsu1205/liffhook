<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ä¿ç•™åº§ä½</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      // éœéŸ³éå¿…è¦çš„ console è¼¸å‡ºï¼ˆä¿ç•™ errorï¼‰ï¼Œå¯é€é window.__ENABLE_DEBUG__ = true é‡æ–°é–‹å•Ÿ
      ;(function () {
        try {
          if (!window.__ENABLE_DEBUG__) {
            var noop = function () {}
            if (window.console) {
              console.log = noop
              console.info = noop
              console.debug = noop
              console.warn = noop
            }
          }
        } catch (e) {
          // å¿½ç•¥è¦†å¯«å¤±æ•—
        }
      })()
    </script>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Noto Sans TC", Arial, sans-serif;
        background: #f5f7fb; /* æ”¹ç‚ºæ·ºç°ç™½åº• */
        margin: 0;
        padding: 0;
        color: #333;
        min-height: 100vh;
        /* background-attachment: fixed; ä¸å†éœ€è¦ */
      }

      .container {
        max-width: 480px;
        margin: 0 auto;
        background: white;
        min-height: 100vh;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }

      /* é ­éƒ¨å€åŸŸ */
      .header {
        background: linear-gradient(135deg, #06c755 0%, #04a73e 100%);
        color: white;
        padding: 20px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: rotate 20s linear infinite;
      }

      @keyframes rotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .header h1 {
        margin: 0;
        font-size: 24px;
        font-weight: 700;
        position: relative;
        z-index: 1;
      }

      .header p {
        margin: 5px 0 0 0;
        opacity: 0.9;
        font-size: 14px;
        position: relative;
        z-index: 1;
      }

      /* ä¸»è¦å…§å®¹å€åŸŸ */
      .main-content {
        padding: 20px;
      }

      /* è¡¨å–®å€åŸŸ */
      .form-section {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #e9ecef;
      }

      .form-section h3 {
        margin: 0 0 15px 0;
        color: #495057;
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .input-group {
        margin-bottom: 20px;
      }

      .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #495057;
        font-size: 14px;
      }

      .required::after {
        content: " *";
        color: #dc3545;
      }

      .input-wrapper {
        position: relative;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        font-size: 16px;
        font-family: inherit;
        transition: all 0.3s ease;
        background: white;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #06c755;
        box-shadow: 0 0 0 3px rgba(6, 199, 85, 0.1);
      }

      /* æœå°‹è¼¸å…¥æ¡†æ¨£å¼ */
      .search-input {
        position: relative;
      }

      .search-input::after {
        content: "ğŸ”";
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }

      /* æœå°‹çµæœåˆ—è¡¨ */
      .search-results {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 2px solid #e9ecef;
        border-top: none;
        border-radius: 0 0 8px 8px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
      }

      .search-results.show {
        display: block;
      }

      .search-result-item {
        padding: 12px 16px;
        cursor: pointer;
        border-bottom: 1px solid #f1f3f4;
        transition: background-color 0.2s ease;
      }

      .search-result-item:hover {
        background-color: #f8f9fa;
      }

      .search-result-item:last-child {
        border-bottom: none;
      }

      .search-result-title {
        font-weight: 500;
        color: #495057;
        margin-bottom: 4px;
      }

      .search-result-desc {
        font-size: 12px;
        color: #6c757d;
      }

      /* æŒ‰éˆ•æ¨£å¼ */
      .btn {
        display: inline-block;
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 500;
        text-align: center;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: inherit;
        position: relative;
        overflow: hidden;
      }

      .btn-primary {
        background: linear-gradient(135deg, #06c755 0%, #04a73e 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(6, 199, 85, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(6, 199, 85, 0.4);
      }

      .btn-primary:active {
        transform: translateY(0);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #5a6268;
        transform: translateY(-1px);
      }

      .btn-full {
        width: 100%;
        margin-top: 10px;
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
      }

      /* éŒ¯èª¤è¨Šæ¯ */
      .error-message {
        color: #dc3545;
        font-size: 14px;
        margin-top: 5px;
        display: none;
      }

      .error-message.show {
        display: block;
      }

      .input-error {
        border-color: #dc3545 !important;
      }

      /* æˆåŠŸè¨Šæ¯ */
      .success-message {
        background: #d4edda;
        color: #155724;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 1px solid #c3e6cb;
        display: none;
      }

      .success-message.show {
        display: block;
      }

      /* è¼‰å…¥ä¸­æ¨£å¼ */
      .loading {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .loading.show {
        display: block;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #06c755;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* éš±è—å…ƒç´  */
      .hidden {
        display: none !important;
      }

      /* ä¹˜å®¢é ˆçŸ¥æ¨£å¼ */
      .notice-container {
        background: #e8f4fd;
        border: 2px solid #b3d9f7;
        border-radius: 12px;
        margin: 20px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 123, 255, 0.1);
      }

      .notice-header {
        background: #007bff;
        color: white;
        padding: 15px 20px;
        text-align: center;
      }

      .notice-header h3 {
        margin: 0;
        font-size: 16px;
        font-weight: 600;
      }

      .notice-content {
        padding: 20px;
      }

      .notice-content p {
        margin: 0 0 10px 0;
        font-size: 14px;
        color: #333;
        font-weight: 600;
      }

      .notice-content ol {
        margin: 0;
        padding-left: 20px;
      }

      .notice-content li {
        margin-bottom: 8px;
        font-size: 13px;
        line-height: 1.5;
        color: #555;
      }

      /* æˆåŠŸå‹•ç•« */
      .success-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(6, 199, 85, 0.95);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: white;
      }

      .success-checkmark {
        width: 80px;
        height: 80px;
        border: 4px solid white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
        animation: successPulse 0.6s ease-in-out;
      }

      .success-checkmark::after {
        content: "âœ“";
        font-size: 40px;
        font-weight: bold;
      }

      .success-message-text {
        font-size: 24px;
        font-weight: 600;
        text-align: center;
        margin-bottom: 10px;
      }

      .success-details {
        font-size: 16px;
        text-align: center;
        opacity: 0.9;
      }

      @keyframes successPulse {
        0% {
          transform: scale(0);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      /* å–æ¶ˆæˆåŠŸå‹•ç•«æ¨£å¼ */
      .cancel-success-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(220, 53, 69, 0.95);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: white;
      }

      .cancel-checkmark {
        width: 80px;
        height: 80px;
        border: 4px solid white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
        animation: successPulse 0.6s ease-in-out;
      }

      .cancel-checkmark::after {
        content: "âœ“";
        font-size: 40px;
        font-weight: bold;
      }

      .cancel-message-text {
        font-size: 24px;
        font-weight: 600;
        text-align: center;
        margin-bottom: 10px;
      }

      .cancel-details {
        font-size: 16px;
        text-align: center;
        opacity: 0.9;
      }

      /* è‡ªè¨‚ç¢ºèªå°è©±æ–¹å¡Š */
      .confirm-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(3px);
      }

      .confirm-dialog {
        background: white;
        border-radius: 12px;
        padding: 24px;
        max-width: 320px;
        width: 90%;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        text-align: center;
        animation: fadeInUp 0.3s ease-out;
      }

      .confirm-dialog h3 {
        margin: 0 0 16px 0;
        color: #333;
        font-size: 18px;
        font-weight: 600;
      }

      .confirm-dialog p {
        margin: 0 0 24px 0;
        color: #666;
        font-size: 16px;
        line-height: 1.5;
      }

      .confirm-buttons {
        display: flex;
        gap: 12px;
        justify-content: center;
      }

      .confirm-btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        min-width: 80px;
      }

      .confirm-btn.primary {
        background: #06c755;
        color: white;
      }

      .confirm-btn.primary:hover {
        background: #05b149;
      }

      .confirm-btn.secondary {
        background: #f5f5f5;
        color: #666;
      }

      .confirm-btn.secondary:hover {
        background: #e9e9e9;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (max-width: 480px) {
        .container {
          margin: 0;
          box-shadow: none;
        }

        .main-content {
          padding: 15px;
        }

        .form-section {
          padding: 15px;
        }
      }

      /* æ™‚é–“é¸æ“‡å™¨æ¨£å¼ */
      .time-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }

      .time-selector select {
        padding: 8px 12px;
        font-size: 14px;
      }

      /* åº§ä½æ•¸é‡é¸æ“‡å™¨ */
      .seat-counter {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-top: 10px;
      }

      .counter-btn {
        width: 40px;
        height: 40px;
        border: 2px solid #06c755;
        background: white;
        color: #06c755;
        border-radius: 50%;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }

      .counter-btn:hover {
        background: #06c755;
        color: white;
      }

      .counter-btn:disabled {
        opacity: 0.3;
        cursor: not-allowed;
      }

      .seat-count {
        font-size: 18px;
        font-weight: 600;
        min-width: 30px;
        text-align: center;
      }

      /* é ç´„æ‘˜è¦ */
      .reservation-summary {
        background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
        border: 1px solid #e1bee7;
      }

      .summary-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .summary-item:last-child {
        border-bottom: none;
        font-weight: 600;
        font-size: 16px;
        margin-top: 10px;
        padding-top: 15px;
        border-top: 2px solid rgba(0, 0, 0, 0.1);
      }

      .summary-label {
        color: #6c757d;
        font-size: 14px;
      }

      .summary-value {
        font-weight: 500;
        color: #495057;
      }

      /* æ–°çš„ç«™ç‰Œé¸å–å™¨æ¨£å¼ */
      .stop-selector-button {
        border: 2px solid #dee2e6;
        border-radius: 8px;
        padding: 15px;
        background: white;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
        font-size: 16px;
      }

      .stop-selector-button:hover {
        border-color: #007bff;
        background-color: #f8f9fa;
      }

      .stop-selector-button.selected {
        border-color: #007bff;
        background-color: #e7f3ff;
      }

      .selector-arrow {
        color: #6c757d;
        font-size: 12px;
      }

      /* ç«™ç‰Œé¸å–å…¨é è¦–çª— */
      .stop-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 10000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
      }

      .stop-modal-content {
        background: white;
        border-radius: 12px;
        width: 100%;
        max-width: 500px;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .stop-modal-header {
        padding: 20px;
        border-bottom: 1px solid #dee2e6;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f8f9fa;
        border-radius: 12px 12px 0 0;
      }

      .stop-modal-header h2 {
        margin: 0;
        color: #333;
        font-size: 18px;
        font-weight: 600;
      }

      .stop-modal-close {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #6c757d;
        padding: 0;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .stop-modal-close:hover {
        color: #dc3545;
      }

      .stop-modal-body {
        flex: 1;
        overflow-y: auto;
        padding: 15px;
      }

      .stop-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
      }

      .stop-item {
        border: 2px solid #dee2e6;
        border-radius: 6px;
        padding: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: white;
        position: relative;
        min-height: 60px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
      }

      .stop-item:hover {
        border-color: #007bff;
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
      }

      .stop-item.selected {
        border-color: #007bff;
        background-color: #e7f3ff;
      }

      .stop-name {
        font-weight: 600;
        font-size: 16px;
        color: #333;
        margin: 0;
        line-height: 1.3;
        word-break: break-all;
      }

      /* ç«™ç‰Œä¸‹æ¡†ç·šé¡è‰²åˆ†çµ„ */
      .stop-route-208802 {
        border-bottom: 6px solid #007bff !important; /* è—è‰² - 208802 è·¯ç·š */
      }

      .stop-route-2088A2 {
        border-bottom: 6px solid #28a745 !important; /* ç¶ è‰² - 2088A2 è·¯ç·š */
      }

      .stop-route-2088B2 {
        border-bottom: 6px solid #fd7e14 !important; /* æ©™è‰² - 2088B2 è·¯ç·š */
      }

      .stop-route-default {
        border-bottom: 6px solid #6c757d !important; /* ç°è‰² - å…¶ä»– */
      }

      /* æ‰‹æ©ŸéŸ¿æ‡‰å¼ */
      @media (max-width: 768px) {
        .stop-modal {
          padding: 5px;
        }

        .stop-modal-content {
          max-height: 95vh;
        }

        .stop-modal-header {
          padding: 15px;
        }

        .stop-modal-body {
          padding: 10px;
        }

        .stop-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 8px;
        }

        .stop-item {
          padding: 6px;
          min-height: 50px;
        }

        .stop-name {
          font-size: 15px;
        }
      }

      @media (max-width: 480px) {
        .stop-grid {
          grid-template-columns: 1fr;
          gap: 6px;
        }

        .stop-item {
          padding: 6px;
          min-height: 45px;
        }

        .stop-name {
          font-size: 14px;
        }
      }

      /* åœ–ä¾‹æ¨£å¼ */
      .route-legend {
        margin-bottom: 15px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #dee2e6;
      }

      .legend-title {
        font-size: 16px;
        font-weight: 600;
        color: #495057;
        margin-bottom: 10px;
        text-align: center;
      }

      .legend-items {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #495057;
        font-weight: 500;
      }

      .legend-color {
        width: 24px;
        height: 5px;
        border-radius: 3px;
      }

      .legend-color.route-208802 {
        background-color: #007bff;
      }

      .legend-color.route-2088A2 {
        background-color: #28a745;
      }

      .legend-color.route-2088B2 {
        background-color: #fd7e14;
      }

      .legend-color.route-default {
        background-color: #6c757d;
      }

      @media (max-width: 480px) {
        .legend-items {
          gap: 12px;
        }

        .legend-item {
          font-size: 13px;
        }

        .legend-color {
          width: 20px;
          height: 4px;
        }
      }
    </style>
  </head>

  <body>
    <!-- è‡ªè¨‚ç¢ºèªå°è©±æ–¹å¡Š -->
    <div id="confirmOverlay" class="confirm-overlay hidden">
      <div class="confirm-dialog">
        <h3>ç¢ºèªæ“ä½œ</h3>
        <p id="confirmMessage">æ‚¨ç¢ºå®šè¦åŸ·è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
        <div class="confirm-buttons">
          <button id="confirmCancel" class="confirm-btn secondary">å–æ¶ˆ</button>
          <button id="confirmOk" class="confirm-btn primary">ç¢ºå®š</button>
        </div>
      </div>
    </div>

    <!-- æˆåŠŸå‹•ç•« -->
    <div id="successAnimation" class="success-animation hidden">
      <div class="success-checkmark"></div>
      <div class="success-message-text">é€å‡ºæˆåŠŸï¼</div>
      <div class="success-details">æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„ä¿ç•™åº§ä½é€šçŸ¥</div>
    </div>

    <!-- å–æ¶ˆæˆåŠŸå‹•ç•« -->
    <div id="cancelSuccessAnimation" class="cancel-success-animation hidden">
      <div class="cancel-checkmark"></div>
      <div class="cancel-message-text">å–æ¶ˆæˆåŠŸï¼</div>
      <div class="cancel-details">æ‚¨çš„ä¿ç•™åº§ä½éœ€æ±‚å·²å–æ¶ˆ</div>
    </div>

    <div class="container">
      <!-- é ­éƒ¨å€åŸŸ -->
      <div class="header">
        <h1>ç”³è«‹ä¿ç•™åº§ä½</h1>
      </div>

      <!-- ä¹˜å®¢é ˆçŸ¥ -->
      <div class="notice-container">
        <div class="notice-header">
          <h3>ğŸ“‹ ä¹˜å®¢é ˆçŸ¥</h3>
        </div>
        <div class="notice-content">
          <p><strong>æ•¬å‘Šä¹˜å®¢ï¼š</strong></p>
          <ol>
            <li>æœ¬åŠŸèƒ½ç›®å‰åƒ…é–‹æ”¾2088è·¯ç·šä½¿ç”¨ã€‚</li>
            <li>ä¿ç•™åº§ä½è«‹ä¾æ’å®šçš„è»Šè™ŸåŠç«™ç‰Œä¸Šè»Šã€‚</li>
            <li>
              ä¸Šè»Šå¾Œè«‹ä½¿ç”¨LINEé¸å–®çš„ã€Œæ­ä¹˜ç¢ºèªã€æƒæQRCodeç¢ºèªæ­ä¹˜ï¼Œè‹¥éä¿ç•™çš„è¶Ÿæ¬¡å‰‡ç„¡æ³•ç¢ºèªã€‚
            </li>
            <li>è‹¥æ‚¨å·²æ­ä¹˜éä¿ç•™çš„è¶Ÿæ¬¡ï¼Œè«‹è¨˜å¾—æ–¼ç•¶æ—¥å–æ¶ˆä¿ç•™ã€‚</li>
            <li>
              ç›®å‰2088Bç‚ºè©¦è¾¦è·¯ç·šï¼Œæ¯æ—¥18:00æ•…å®šç­æ¬¡ï¼Œè«‹ç•™çµ¦ä¿¡ä¸­å¾Œç«™-å°åŒ—æ‚ æ´»æ‘çš„ä¹˜å®¢ï¼Œéå¸¸æ„Ÿè¬ã€‚
            </li>
          </ol>
        </div>
      </div>

      <!-- ä¸»è¦å…§å®¹ -->
      <div class="main-content">
        <!-- ç¾æœ‰é ç´„é¡¯ç¤º -->
        <div id="existingReservation" class="form-section hidden">
          <h3>âš ï¸ æ‚¨é‚„æœ‰å°šæœªæ­ä¹˜çš„ä¿ç•™åº§ä½</h3>
          <div
            style="
              background: #fff3cd;
              border: 2px solid #ffc107;
              border-radius: 8px;
              padding: 20px;
            "
          >
            <div class="reservation-details">
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span style="color: #856404; font-weight: 500">ä¹˜è»Šç«™ç‰Œï¼š</span>
                <span
                  id="existingKeepStop"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span style="color: #856404; font-weight: 500">ä¸‹è»Šç«™ç‰Œï¼š</span>
                <span
                  id="existingDestStop"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span style="color: #856404; font-weight: 500">ä¹˜å®¢ç¨±å‘¼ï¼š</span>
                <span
                  id="existingName"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span style="color: #856404; font-weight: 500">åº§ä½æ•¸é‡ï¼š</span>
                <span
                  id="existingSeatCount"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 10px;
                "
              >
                <span style="color: #856404; font-weight: 500">é ç´„æ™‚é–“ï¼š</span>
                <span
                  id="existingDateTime"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 15px;
                "
              >
                <span style="color: #856404; font-weight: 500">ç‹€æ…‹ï¼š</span>
                <span
                  id="existingStatus"
                  style="color: #856404; font-weight: 600"
                ></span>
              </div>
              <button
                id="cancelReservationBtn"
                onclick="cancelExistingReservation()"
                style="
                  width: 100%;
                  background: #dc3545;
                  color: white;
                  border: none;
                  padding: 12px;
                  border-radius: 8px;
                  font-size: 16px;
                  font-weight: 500;
                  cursor: pointer;
                  transition: all 0.3s ease;
                "
              >
                å–æ¶ˆé ç´„
              </button>
            </div>
          </div>
        </div>

        <!-- è¼‰å…¥ä¸­ -->
        <div id="loadingMessage" class="loading">
          <div class="spinner"></div>
          <p>è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</p>
        </div>

        <!-- é ç´„è¡¨å–® -->
        <form id="reservationForm" class="hidden">
          <!-- ä¹˜è»Šç«™ç‰Œé¸æ“‡ -->
          <div class="form-section">
            <h3>ğŸ“ é¸æ“‡ä¹˜è»Šç«™ç‰Œ</h3>
            <div class="input-group">
              <label for="keepStopDisplay" class="required">ä¹˜è»Šç«™ç‰Œ</label>
              <div class="input-wrapper">
                <div
                  id="keepStopDisplay"
                  class="stop-selector-button"
                  onclick="openKeepStopSelector()"
                >
                  <span id="keepStopDisplayText">é»æ“Šé¸æ“‡ä¹˜è»Šç«™ç‰Œ</span>
                  <span class="selector-arrow">â–¼</span>
                </div>
              </div>
              <div id="keepStopError" class="error-message"></div>
            </div>
          </div>

          <!-- ä¸‹è»Šç«™ç‰Œé¸æ“‡ -->
          <div class="form-section">
            <h3>ğŸ¯ é¸æ“‡ä¸‹è»Šç«™ç‰Œ</h3>
            <div class="input-group">
              <label for="destStopDisplay" class="required">ä¸‹è»Šç«™ç‰Œ</label>
              <div class="input-wrapper">
                <div
                  id="destStopDisplay"
                  class="stop-selector-button"
                  onclick="openDestStopSelector()"
                >
                  <span id="destStopDisplayText">é»æ“Šé¸æ“‡ä¸‹è»Šç«™ç‰Œ</span>
                  <span class="selector-arrow">â–¼</span>
                </div>
              </div>
              <div id="destStopError" class="error-message"></div>
            </div>
          </div>

          <!-- ä¹˜å®¢è³‡è¨Š -->
          <div class="form-section">
            <h3>ğŸ‘¤ ä¹˜å®¢è³‡è¨Š</h3>
            <div class="input-group">
              <label for="passengerName" class="required">ç¨±å‘¼</label>
              <div style="display: flex; gap: 8px; align-items: center">
                <input
                  type="text"
                  id="passengerName"
                  placeholder="è«‹è¼¸å…¥æ‚¨çš„ç¨±å‘¼"
                  maxlength="20"
                  style="flex: 1"
                />
                <select
                  id="passengerTitle"
                  aria-label="ç¨±è¬‚"
                  style="width: 100px"
                >
                  <option value="">(ç„¡)</option>
                  <option value="å…ˆç”Ÿ">å…ˆç”Ÿ</option>
                  <option value="å°å§">å°å§</option>
                </select>
              </div>
              <div id="nameError" class="error-message"></div>
            </div>

            <div class="input-group">
              <label for="passengerPhone" class="required">é›»è©±è™Ÿç¢¼</label>
              <input
                type="tel"
                id="passengerPhone"
                placeholder="è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼ï¼ˆä¾‹ï¼š0912345678ï¼‰"
                maxlength="10"
              />
              <div id="phoneError" class="error-message"></div>
            </div>
          </div>

          <!-- åº§ä½æ•¸é‡ -->
          <div class="form-section">
            <h3>ğŸª‘ åº§ä½æ•¸é‡</h3>
            <div class="input-group">
              <label>éœ€è¦ä¿ç•™çš„åº§ä½æ•¸</label>
              <div class="seat-counter">
                <button
                  type="button"
                  class="counter-btn"
                  onclick="decreaseSeatCount()"
                  id="decreaseBtn"
                >
                  âˆ’
                </button>
                <span class="seat-count" id="seatCount">1</span>
                <button
                  type="button"
                  class="counter-btn"
                  onclick="increaseSeatCount()"
                  id="increaseBtn"
                >
                  +
                </button>
              </div>
            </div>
          </div>

          <!-- é ç´„æ‘˜è¦ -->
          <div id="reservationSummary" class="reservation-summary hidden">
            <h3>ğŸ“‹ é ç´„æ‘˜è¦</h3>
            <div class="summary-item">
              <span class="summary-label">ä¹˜è»Šç«™ç‰Œï¼š</span>
              <span class="summary-value" id="summaryKeepStop">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">ä¸‹è»Šç«™ç‰Œï¼š</span>
              <span class="summary-value" id="summaryDestStop">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">æ‚¨çš„ç¨±å‘¼ï¼š</span>
              <span class="summary-value" id="summaryName">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">è¯çµ¡é›»è©±ï¼š</span>
              <span class="summary-value" id="summaryPhone">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">é ç´„æ™‚é–“ï¼š</span>
              <span class="summary-value" id="summaryDateTime">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">åº§ä½æ•¸é‡ï¼š</span>
              <span class="summary-value" id="summarySeatCount">1</span>
            </div>
          </div>

          <!-- æäº¤æŒ‰éˆ• -->
          <button type="submit" class="btn btn-primary btn-full" id="submitBtn">
            ç¢ºèªé€å‡ºä¿ç•™ç”³è«‹
          </button>
        </form>
      </div>
    </div>

    <footer
      style="
        background: #ffffff;
        color: #6c757d;
        text-align: center;
        margin: 20px 0 40px;
        padding: 12px 0;
        border-top: 1px solid #e9ecef;
        font-size: 12px;
      "
    >
      ä¿ç•™åº§ä½ç”³è«‹ v1.0.0.9
    </footer>

    <script>
      // å…¨åŸŸè®Šæ•¸
      //const API_BASE_URL = "http://localhost:5000/api"
      const API_BASE_URL = "https://35.221.146.143.nip.io/linehook/keepseat"
      let keepStops = []
      let destStops = []
      let seatCount = 1
      let currentUser = null
      let currentReservation = null

      // èª¿è©¦å‡½æ•¸
      // åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", async function () {
        try {
          showLoading(true)

          await initializeLiff()
          await loadUserProfile()
          await loadStops()
          initializeEventListeners()
          await checkExistingReservation()

          showLoading(false)
        } catch (error) {
          console.error("åˆå§‹åŒ–å¤±æ•—:", error)
          showError("ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢")
          showLoading(false)
        }
      })

      // LIFF åˆå§‹åŒ–
      async function initializeLiff() {
        try {
          await liff.init({ liffId: "2007942695-GA2M48Aj" })
          console.log("LIFF åˆå§‹åŒ–æˆåŠŸ")
        } catch (error) {
          console.error("LIFF åˆå§‹åŒ–å¤±æ•—:", error)
          throw error
        }
      }

      // è¼‰å…¥ç”¨æˆ¶è³‡æ–™
      async function loadUserProfile() {
        try {
          if (liff.isLoggedIn()) {
            const profile = await liff.getProfile()
            currentUser = {
              userId: profile.userId,
              displayName: profile.displayName,
              pictureUrl: profile.pictureUrl,
            }
            console.log("ç”¨æˆ¶è³‡æ–™è¼‰å…¥å®Œæˆ:", currentUser)
          } else {
            console.log("ç”¨æˆ¶æœªç™»å…¥ï¼Œé–‹å§‹ç™»å…¥æµç¨‹")
            liff.login()
            // ç™»å…¥å¾Œé é¢æœƒé‡æ–°è¼‰å…¥ï¼Œæ‰€ä»¥é€™è£¡ç›´æ¥è¿”å›
            return
          }
        } catch (error) {
          console.error("è¼‰å…¥ç”¨æˆ¶è³‡æ–™å¤±æ•—:", error)
          throw error
        }
      }

      // æª¢æŸ¥ç¾æœ‰é ç´„
      async function checkExistingReservation() {
        if (!currentUser || !currentUser.userId) {
          console.log("ç”¨æˆ¶è³‡è¨Šæœªè¼‰å…¥ï¼Œè·³éé ç´„æª¢æŸ¥")
          return
        }

        console.log("é–‹å§‹æª¢æŸ¥ç¾æœ‰é ç´„ï¼Œç”¨æˆ¶ID:", currentUser.userId)

        try {
          const response = await fetch(
            `${API_BASE_URL}/check-existing/${currentUser.userId}`
          )

          console.log("é ç´„æª¢æŸ¥å›æ‡‰ç‹€æ…‹:", response.status)

          // å˜—è©¦è®€å–å›æ‡‰å…§å®¹
          let responseText = ""
          try {
            responseText = await response.text()
            console.log("åŸå§‹å›æ‡‰å…§å®¹:", responseText)
          } catch (e) {
            console.error("è®€å–å›æ‡‰å¤±æ•—:", e)
            responseText = ""
          }

          if (response.ok) {
            // æˆåŠŸå›æ‡‰ï¼Œå˜—è©¦è§£æJSON
            let result = null
            try {
              result = JSON.parse(responseText)
              console.log("è§£æçš„JSONçµæœ:", result)
            } catch (parseError) {
              console.warn("JSONè§£æå¤±æ•—:", parseError)
              showReservationForm()
              return
            }

            if (result.hasExisting && result.data) {
              console.log("ç™¼ç¾ç¾æœ‰é ç´„:", result.data)
              currentReservation = result.data
              displayExistingReservation(result.data)
              hideReservationForm()
            } else {
              console.log("æ²’æœ‰ç¾æœ‰é ç´„")
              currentReservation = null
              hideExistingReservation()
              showReservationForm()
            }
          } else {
            // éŒ¯èª¤å›æ‡‰ï¼Œæª¢æŸ¥æ˜¯å¦åŒ…å«é ç´„ä¿¡æ¯
            console.log(
              "APIå›å‚³éŒ¯èª¤ï¼Œç‹€æ…‹ç¢¼:",
              response.status,
              "å…§å®¹:",
              responseText
            )

            // å˜—è©¦è§£æéŒ¯èª¤å›æ‡‰ä¸­çš„JSONï¼ˆæœ‰äº›éŒ¯èª¤å›æ‡‰å¯èƒ½åŒ…å«é ç´„ä¿¡æ¯ï¼‰
            try {
              const errorResult = JSON.parse(responseText)
              console.log("éŒ¯èª¤å›æ‡‰çš„JSON:", errorResult)

              // å¦‚æœéŒ¯èª¤å›æ‡‰ä¸­åŒ…å«é ç´„ä¿¡æ¯
              if (errorResult.reservation) {
                console.log(
                  "åœ¨éŒ¯èª¤å›æ‡‰ä¸­ç™¼ç¾é ç´„ä¿¡æ¯:",
                  errorResult.reservation
                )
                currentReservation = errorResult.reservation
                displayExistingReservation(errorResult.reservation)
                hideReservationForm()
                return
              }
            } catch (jsonError) {
              console.log("éŒ¯èª¤å›æ‡‰ä¸æ˜¯JSONæ ¼å¼")
            }

            // æª¢æŸ¥æ–‡å­—å…§å®¹æ˜¯å¦æåˆ°æœ‰é ç´„
            if (
              responseText.includes("æœªæ­ä¹˜") ||
              responseText.includes("å·²æœ‰é ç´„") ||
              responseText.includes("ä¿ç•™åº§ä½")
            ) {
              console.log("æª¢æ¸¬åˆ°æœ‰é ç´„ç›¸é—œéŒ¯èª¤è¨Šæ¯")

              // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ä½†ä¸é¡¯ç¤ºè¡¨å–®
              showError("æ‚¨æœ‰æœªå®Œæˆçš„é ç´„ã€‚éŒ¯èª¤è¨Šæ¯ï¼š" + responseText)
              hideReservationForm()

              // å‰µå»ºä¸€å€‹è‡¨æ™‚çš„é ç´„é¡¯ç¤º
              const tempReservation = {
                id: "unknown",
                keepStop: "è³‡è¨Šè¼‰å…¥å¤±æ•—",
                destStop: "è³‡è¨Šè¼‰å…¥å¤±æ•—",
                name: "è³‡è¨Šè¼‰å…¥å¤±æ•—",
                seatCount: "æœªçŸ¥",
                requestDateTime: "è³‡è¨Šè¼‰å…¥å¤±æ•—",
                status: "æœ‰æœªå®Œæˆé ç´„ - " + responseText,
              }

              displayExistingReservation(tempReservation)
            } else {
              console.log("æ²’æœ‰é ç´„ç›¸é—œéŒ¯èª¤ï¼Œé¡¯ç¤ºé ç´„è¡¨å–®")
              currentReservation = null
              hideExistingReservation()
              showReservationForm()
            }
          }
        } catch (error) {
          console.error("æª¢æŸ¥ç¾æœ‰é ç´„å¤±æ•—:", error)
          currentReservation = null
          hideExistingReservation()
          showReservationForm()
        }
      }

      // é¡¯ç¤ºç¾æœ‰é ç´„
      function displayExistingReservation(reservation) {
        console.log("é¡¯ç¤ºç¾æœ‰é ç´„è³‡è¨Š:", reservation)

        document.getElementById("existingKeepStop").textContent =
          reservation.keepStop || "æœªçŸ¥"
        document.getElementById("existingDestStop").textContent =
          reservation.destStop || "æœªçŸ¥"
        document.getElementById("existingName").textContent =
          currentUser?.displayName || "æœªçŸ¥"
        document.getElementById("existingSeatCount").textContent =
          reservation.seatCount || "æœªçŸ¥"
        document.getElementById("existingDateTime").textContent =
          reservation.requestDateTime || "æœªçŸ¥"

        // æ ¹æ“šç‹€æ…‹é¡¯ç¤ºä¸åŒçš„è¨Šæ¯å’Œæ¨£å¼
        let statusText = reservation.status || "å¾…å®‰æ’"
        let backgroundColor = "#fff3cd"
        let borderColor = "#ffc107"

        if (reservation.tripId) {
          // å·²å®‰æ’çš„é ç´„
          statusText = "å¾…å®‰æ’è»Šè¼›"
          backgroundColor = "#d1ecf1"
          borderColor = "#bee5eb"
        } else {
          // æœªå®‰æ’çš„é ç´„
          statusText = "å¾…å®‰æ’è»Šè¼›"
        }

        // æª¢æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šç‹€æ…‹æ¨™è¨˜
        if (
          reservation.isUnridden ||
          (reservation.status && reservation.status.includes("æœªæ­ä¹˜"))
        ) {
          statusText = "âš ï¸ æœªæ­ä¹˜ - è«‹åŠæ™‚å–æ¶ˆæˆ–æº–æ™‚æ­ä¹˜"
          backgroundColor = "#f8d7da"
          borderColor = "#f5c6cb"
        }

        document.getElementById("existingStatus").textContent = statusText

        // æ›´æ–°èƒŒæ™¯è‰²
        const reservationElement = document.getElementById(
          "existingReservation"
        )
        const detailsDiv = reservationElement.querySelector(
          "div[style*='background']"
        )
        if (detailsDiv) {
          detailsDiv.style.background = backgroundColor
          detailsDiv.style.borderColor = borderColor
        }

        console.log("é¡¯ç¤ºç¾æœ‰é ç´„å€åŸŸ")
        document
          .getElementById("existingReservation")
          .classList.remove("hidden")
      }

      // éš±è—ç¾æœ‰é ç´„
      function hideExistingReservation() {
        console.log("éš±è—ç¾æœ‰é ç´„å€åŸŸ")
        document.getElementById("existingReservation").classList.add("hidden")
      }

      // é¡¯ç¤ºé ç´„è¡¨å–®
      function showReservationForm() {
        console.log("é¡¯ç¤ºé ç´„è¡¨å–®")
        document.getElementById("reservationForm").classList.remove("hidden")
      }

      // éš±è—é ç´„è¡¨å–®
      function hideReservationForm() {
        console.log("éš±è—é ç´„è¡¨å–®")
        document.getElementById("reservationForm").classList.add("hidden")
      }

      // å–æ¶ˆç¾æœ‰é ç´„
      async function cancelExistingReservation() {
        if (!currentReservation) {
          return
        }

        const shouldCancel = await showConfirm("ç¢ºå®šè¦å–æ¶ˆç•¶å‰çš„é ç´„å—ï¼Ÿ")
        if (!shouldCancel) return

        try {
          showLoading(true)

          const response = await fetch(`${API_BASE_URL}/cancel`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              keepSeatId: currentReservation.id,
              userId: currentUser.userId,
            }),
          })

          if (response.ok) {
            showCancelSuccessAnimation()
            setTimeout(() => {
              document
                .getElementById("cancelSuccessAnimation")
                .classList.add("hidden")
              hideExistingReservation()
              showReservationForm()
              currentReservation = null
            }, 2000)
          } else {
            let errorText = ""
            try {
              errorText = await response.text()
            } catch (e) {
              errorText = "å–æ¶ˆé ç´„å¤±æ•—"
            }
            alert(`å–æ¶ˆé ç´„å¤±æ•—: ${errorText}`)
          }
        } catch (error) {
          console.error("å–æ¶ˆé ç´„å¤±æ•—:", error)
          alert("å–æ¶ˆé ç´„æ™‚ç™¼ç”ŸéŒ¯èª¤")
        } finally {
          showLoading(false)
        }
      }

      // è¼‰å…¥ç«™ç‰Œè³‡æ–™
      async function loadStops() {
        try {
          // è¼‰å…¥ä¹˜è»Šç«™ç‰Œ
          const keepResponse = await fetch(`${API_BASE_URL}/keep-stops`)
          if (keepResponse.ok) {
            const keepResult = await keepResponse.json()
            keepStops = keepResult.data || []
            console.log(`è¼‰å…¥äº† ${keepStops.length} å€‹ä¹˜è»Šç«™ç‰Œ`)
          }

          // è¼‰å…¥ä¸‹è»Šç«™ç‰Œ
          const destResponse = await fetch(`${API_BASE_URL}/dest-stops`)
          if (destResponse.ok) {
            const destResult = await destResponse.json()
            destStops = destResult.data || []
            console.log(`è¼‰å…¥äº† ${destStops.length} å€‹ä¸‹è»Šç«™ç‰Œ`)
          }

          if (keepStops.length === 0 || destStops.length === 0) {
            showError("ç«™ç‰Œè³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹è¯ç¹«å®¢æœ")
          }
        } catch (error) {
          console.error("è¼‰å…¥ç«™ç‰Œè³‡æ–™å¤±æ•—:", error)
          keepStops = []
          destStops = []
          showError("è¼‰å…¥ç«™ç‰Œè³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤")
        }
      }

      // ç«™ç‰Œé¸å–å™¨ç›¸é—œåŠŸèƒ½
      let currentStops = [] // å„²å­˜ç›®å‰çš„ç«™ç‰Œè³‡æ–™
      let currentSelector = null // è¨˜éŒ„ç›®å‰é¸å–çš„é¸å–å™¨é¡å‹

      // é–‹å•Ÿä¸Šè»Šç«™ç‰Œé¸å–å™¨
      function openKeepStopSelector() {
        currentSelector = "keep"
        loadStopsAndShowModal("é¸æ“‡ä¸Šè»Šç«™ç‰Œ")
      }

      // é–‹å•Ÿä¸‹è»Šç«™ç‰Œé¸å–å™¨
      function openDestStopSelector() {
        currentSelector = "dest"
        loadStopsAndShowModal("é¸æ“‡ä¸‹è»Šç«™ç‰Œ")
      }

      // è¼‰å…¥ç«™ç‰Œè³‡æ–™ä¸¦é¡¯ç¤ºé¸å–è¦–çª—
      async function loadStopsAndShowModal(title) {
        try {
          showLoading(true)

          // æ ¹æ“šé¸æ“‡å™¨é¡å‹è¼‰å…¥å°æ‡‰çš„ç«™ç‰Œè³‡æ–™
          let stopsToShow = []
          if (currentSelector === "keep") {
            // ä¸Šè»Šç«™ç‰Œï¼šå¾ keep-stops API è¼‰å…¥
            const response = await fetch(`${API_BASE_URL}/keep-stops`)
            if (response.ok) {
              const result = await response.json()
              stopsToShow = result.data || []
            }
          } else if (currentSelector === "dest") {
            // ä¸‹è»Šç«™ç‰Œï¼šå¾ dest-stops API è¼‰å…¥
            const response = await fetch(`${API_BASE_URL}/dest-stops`)
            if (response.ok) {
              const result = await response.json()
              stopsToShow = result.data || []
            }
          }

          // æ’åºç«™ç‰Œ
          currentStops = stopsToShow // sortStopsByRoute(stopsToShow)

          showLoading(false)

          // å¦‚æœåªæœ‰ä¸€å€‹ç«™ç‰Œï¼Œè‡ªå‹•é¸æ“‡
          if (currentStops.length === 1) {
            const onlyStop = currentStops[0]

            // æ›´æ–°å°æ‡‰çš„é¡¯ç¤ºæ¬„ä½
            if (currentSelector === "keep") {
              document.getElementById("keepStopDisplayText").textContent =
                onlyStop.stopName
              document
                .getElementById("keepStopDisplay")
                .classList.add("selected")
            } else if (currentSelector === "dest") {
              document.getElementById("destStopDisplayText").textContent =
                onlyStop.stopName
              document
                .getElementById("destStopDisplay")
                .classList.add("selected")
            }

            // æ›´æ–°æ‘˜è¦
            updateSummary()

            // ä¸é¡¯ç¤ºé¸å–è¦–çª—
            currentSelector = null
            return
          }

          showStopModal(title)
        } catch (error) {
          showLoading(false)
          showError("è¼‰å…¥ç«™ç‰Œè³‡æ–™å¤±æ•—: " + error.message)
        }
      }

      // æ ¹æ“šè·¯ç·šæ’åºç«™ç‰Œ
      function sortStopsByRoute(stops) {
        return stops.sort((a, b) => {
          // å®šç¾©è·¯ç·šå„ªå…ˆé †åº
          const getRoutePriority = (stop) => {
            if (stop.routes.some((route) => route === "208802")) return 1
            if (stop.routes.some((route) => route === "2088A2")) return 2
            if (stop.routes.some((route) => route === "2088B2")) return 3
            return 999 // å…¶ä»–è·¯ç·šæ’åœ¨æœ€å¾Œ
          }

          // æª¢æŸ¥æ˜¯å¦åŒ…å«ç‰¹å®šè·¯ç·š
          const hasRoute2088B2 = (stop) =>
            stop.routes.some((route) => route === "2088B2")

          const priorityA = getRoutePriority(a)
          const priorityB = getRoutePriority(b)

          // 1. é¦–å…ˆæŒ‰è·¯ç·šå„ªå…ˆé †åºæ’åº
          if (priorityA !== priorityB) {
            return priorityA - priorityB
          }

          // 2. ç›¸åŒå„ªå…ˆé †åºå…§çš„æ’åº
          if (priorityA === priorityB) {
            // ç‰¹æ®Šè™•ç†ï¼šåªæœ‰ä¸€æ¢è·¯ç·šçš„ç«™ç‰Œæ’åœ¨æœ€å¾Œ
            const isOnlyOneRouteA = a.routes.length === 1
            const isOnlyOneRouteB = b.routes.length === 1

            if (isOnlyOneRouteA && !isOnlyOneRouteB) {
              return 1 // A æ’åœ¨å¾Œé¢
            }
            if (!isOnlyOneRouteA && isOnlyOneRouteB) {
              return -1 // B æ’åœ¨å¾Œé¢
            }

            // æ ¹æ“šè·¯ç·šé¡å‹é¸æ“‡æ’åºæ–¹å¼
            if (hasRoute2088B2(a) || hasRoute2088B2(b)) {
              // 2088B2 è·¯ç·šä½¿ç”¨ minSequence æ’åº
              if (a.minSequence !== b.minSequence) {
                return a.minSequence - b.minSequence
              }
            } else {
              // å…¶ä»–è·¯ç·šä½¿ç”¨ stopUID æ’åº
              if (a.stopUID !== b.stopUID) {
                return (a.stopUID || "").localeCompare(b.stopUID || "")
              }
            }

            // æœ€å¾ŒæŒ‰ç«™ç‰Œåç¨±æ’åº
            return a.stopName.localeCompare(b.stopName, "zh-TW")
          }

          return 0
        })
      }

      // é¡¯ç¤ºç«™ç‰Œé¸å–è¦–çª—
      function showStopModal(title) {
        const modal = document.getElementById("stopModal")
        const modalTitle = modal.querySelector(".stop-modal-header h2")
        const stopGrid = modal.querySelector(".stop-grid")
        const legendContainer = modal.querySelector(".legend-items")

        modalTitle.textContent = title
        stopGrid.innerHTML = ""

        // ç”Ÿæˆåœ–ä¾‹
        generateRouteLegend(legendContainer)

        // ç”Ÿæˆç«™ç‰Œé …ç›®
        currentStops.forEach((stop, index) => {
          const stopItem = createStopItem(stop, index)
          stopGrid.appendChild(stopItem)
        })

        modal.style.display = "flex"
      }

      // ç”Ÿæˆè·¯ç·šåœ–ä¾‹
      function generateRouteLegend(container) {
        container.innerHTML = ""

        // æ”¶é›†ç•¶å‰ç«™ç‰Œä¸­å­˜åœ¨çš„è·¯ç·š
        const availableRoutes = new Set()
        currentStops.forEach((stop) => {
          stop.routes.forEach((route) => availableRoutes.add(route))
        })

        // å®šç¾©è·¯ç·šé¡è‰²å°æ‡‰
        const routeColors = [
          { route: "208802", name: "208802", colorClass: "route-208802" },
          { route: "2088A2", name: "2088A2", colorClass: "route-2088A2" },
          { route: "2088B2", name: "2088B2", colorClass: "route-2088B2" },
        ]

        // åªé¡¯ç¤ºå­˜åœ¨çš„è·¯ç·šåœ–ä¾‹
        routeColors.forEach((routeInfo) => {
          if (availableRoutes.has(routeInfo.route)) {
            const legendItem = document.createElement("div")
            legendItem.className = "legend-item"

            legendItem.innerHTML = `
              <div class="legend-color ${routeInfo.colorClass}"></div>
              <span>${routeInfo.name}</span>
            `

            container.appendChild(legendItem)
          }
        })

        // å¦‚æœæœ‰å…¶ä»–è·¯ç·šï¼Œé¡¯ç¤ºé è¨­é¡è‰²åœ–ä¾‹
        const hasOtherRoutes = Array.from(availableRoutes).some(
          (route) => !["208802", "2088A2", "2088B2"].includes(route)
        )

        if (hasOtherRoutes) {
          const legendItem = document.createElement("div")
          legendItem.className = "legend-item"

          legendItem.innerHTML = `
            <div class="legend-color route-default"></div>
            <span>å…¶ä»–è·¯ç·š</span>
          `

          container.appendChild(legendItem)
        }
      }

      // å»ºç«‹ç«™ç‰Œé …ç›®å…ƒç´ 
      function createStopItem(stop, index) {
        const div = document.createElement("div")
        div.className = "stop-item"
        div.setAttribute("data-index", index)

        // æ ¹æ“šç«™ç‰ŒåŒ…å«çš„è·¯ç·šæ±ºå®šé¡è‰²é¡åˆ¥
        const stopColorClass = getStopColorClass(stop.stopName, stop.routes)
        div.classList.add(stopColorClass)

        div.innerHTML = `
          <div class="stop-name">${stop.stopName}</div>
        `

        // åŠ å…¥é»æ“Šäº‹ä»¶
        div.addEventListener("click", () => selectStop(stop, div))

        return div
      }

      // æ ¹æ“šç«™ç‰ŒåŒ…å«çš„è·¯ç·šæ±ºå®šé¡è‰²é¡åˆ¥
      function getStopColorClass(stopName, routes) {
        // æ ¹æ“šç«™ç‰ŒåŒ…å«çš„è·¯ç·šä¾†æ±ºå®šé¡è‰²
        if (routes.includes("208802")) {
          return "stop-route-208802"
        } else if (routes.includes("2088A2")) {
          return "stop-route-2088A2"
        } else if (routes.includes("2088B2")) {
          return "stop-route-2088B2"
        } else {
          return "stop-route-default"
        }
      }

      // é¸å–ç«™ç‰Œ
      function selectStop(stop, element) {
        // ç§»é™¤å…¶ä»–é¸å–ç‹€æ…‹
        document.querySelectorAll(".stop-item.selected").forEach((item) => {
          item.classList.remove("selected")
        })

        // åŠ å…¥é¸å–ç‹€æ…‹
        element.classList.add("selected")

        // æ›´æ–°å°æ‡‰çš„é¡¯ç¤ºæ¬„ä½
        if (currentSelector === "keep") {
          document.getElementById("keepStopDisplayText").textContent =
            stop.stopName
          document.getElementById("keepStopDisplay").classList.add("selected")
        } else if (currentSelector === "dest") {
          document.getElementById("destStopDisplayText").textContent =
            stop.stopName
          document.getElementById("destStopDisplay").classList.add("selected")
        }

        // æ›´æ–°æ‘˜è¦
        updateSummary()

        // é—œé–‰è¦–çª—
        setTimeout(() => {
          closeStopSelector()
        }, 200)
      }

      // é—œé–‰ç«™ç‰Œé¸å–è¦–çª—
      function closeStopSelector() {
        const modal = document.getElementById("stopModal")
        modal.style.display = "none"
        currentSelector = null
      }

      // æ ¼å¼åŒ–ç•¶å‰æ™‚é–“ç‚ºAPIæ ¼å¼
      function getCurrentDateTime() {
        const now = new Date()
        const year = now.getFullYear()
        const month = String(now.getMonth() + 1).padStart(2, "0")
        const day = String(now.getDate()).padStart(2, "0")
        const hours = String(now.getHours()).padStart(2, "0")
        const minutes = String(now.getMinutes()).padStart(2, "0")
        const seconds = String(now.getSeconds()).padStart(2, "0")

        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`
      }

      // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
      function initializeEventListeners() {
        // ç«™ç‰Œé¸å–å™¨é»æ“Šäº‹ä»¶
        document
          .getElementById("keepStopDisplay")
          .addEventListener("click", openKeepStopSelector)
        document
          .getElementById("destStopDisplay")
          .addEventListener("click", openDestStopSelector)

        // ç«™ç‰Œé¸å–è¦–çª—é—œé–‰æŒ‰éˆ•
        document
          .querySelector(".stop-modal-close")
          .addEventListener("click", closeStopSelector)

        // é»æ“Šè¦–çª—å¤–éƒ¨é—œé–‰
        document
          .getElementById("stopModal")
          .addEventListener("click", function (e) {
            if (e.target === this) {
              closeStopSelector()
            }
          })

        // è¡¨å–®æäº¤
        document
          .getElementById("reservationForm")
          .addEventListener("submit", handleFormSubmit)

        // è¼¸å…¥é©—è­‰
        document
          .getElementById("passengerName")
          .addEventListener("blur", validateName)
        // ç¨±è¬‚æ”¹è®Šæ™‚ä¹Ÿæ›´æ–°æ‘˜è¦
        const titleEl = document.getElementById("passengerTitle")
        if (titleEl) {
          titleEl.addEventListener("change", updateSummary)
          titleEl.addEventListener("input", updateSummary)
        }
        document
          .getElementById("passengerPhone")
          .addEventListener("blur", validatePhone)

        // å³æ™‚æ›´æ–°æ‘˜è¦
        document
          .getElementById("passengerName")
          .addEventListener("input", updateSummary)
        document
          .getElementById("passengerPhone")
          .addEventListener("input", updateSummary)
      }

      // è¡¨å–®é©—è­‰
      function validateName() {
        const name = document.getElementById("passengerName").value.trim()
        if (name.length === 0) {
          showError("è«‹è¼¸å…¥ç¨±å‘¼", "nameError", "passengerName")
          return false
        }
        if (name.length > 20) {
          showError("ç¨±å‘¼ä¸èƒ½è¶…é20å€‹å­—ç¬¦", "nameError", "passengerName")
          return false
        }
        clearError("nameError", "passengerName")
        return true
      }

      function validatePhone() {
        const phone = document.getElementById("passengerPhone").value.trim()
        const phoneRegex = /^09\d{8}$/
        if (!phoneRegex.test(phone)) {
          showError(
            "è«‹è¼¸å…¥æ­£ç¢ºçš„æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ï¼ˆ09xxxxxxxxï¼‰",
            "phoneError",
            "passengerPhone"
          )
          return false
        }
        clearError("phoneError", "passengerPhone")
        return true
      }

      function validateStops() {
        let valid = true

        const keepStopName = document
          .getElementById("keepStopDisplay")
          .textContent.trim()
        const destStopName = document
          .getElementById("destStopDisplay")
          .textContent.trim()

        if (!keepStopName || keepStopName === "è«‹é¸æ“‡ä¸Šè»Šç«™ç‰Œ") {
          showError("è«‹é¸æ“‡ä¸Šè»Šç«™ç‰Œ", "keepStopError", "keepStopDisplay")
          valid = false
        } else {
          clearError("keepStopError", "keepStopDisplay")
        }

        if (!destStopName || destStopName === "è«‹é¸æ“‡ä¸‹è»Šç«™ç‰Œ") {
          showError("è«‹é¸æ“‡ä¸‹è»Šç«™ç‰Œ", "destStopError", "destStopDisplay")
          valid = false
        } else {
          clearError("destStopError", "destStopDisplay")
        }

        if (keepStopName && destStopName && keepStopName === destStopName) {
          showError(
            "ä¸Šè»Šç«™ç‰Œèˆ‡ä¸‹è»Šç«™ç‰Œä¸èƒ½ç›¸åŒ",
            "destStopError",
            "destStopDisplay"
          )
          valid = false
        } else {
          clearError("destStopError", "destStopDisplay")
        }

        return valid
      }

      // åº§ä½æ•¸é‡æ§åˆ¶
      function increaseSeatCount() {
        if (seatCount < 4) {
          seatCount++
          updateSeatDisplay()
          updateSummary()
        }
      }

      function decreaseSeatCount() {
        if (seatCount > 1) {
          seatCount--
          updateSeatDisplay()
          updateSummary()
        }
      }

      function updateSeatDisplay() {
        document.getElementById("seatCount").textContent = seatCount
        document.getElementById("decreaseBtn").disabled = seatCount <= 1
        document.getElementById("increaseBtn").disabled = seatCount >= 4
      }

      // è¡¨å–®é©—è­‰
      function validateName() {
        const name = document.getElementById("passengerName").value.trim()
        if (name.length === 0) {
          showError("è«‹è¼¸å…¥ç¨±å‘¼", "nameError", "passengerName")
          return false
        }
        if (name.length > 20) {
          showError("ç¨±å‘¼ä¸èƒ½è¶…é20å€‹å­—ç¬¦", "nameError", "passengerName")
          return false
        }
        clearError("nameError", "passengerName")
        return true
      }

      function validatePhone() {
        const phone = document.getElementById("passengerPhone").value.trim()
        const phoneRegex = /^09\d{8}$/
        if (!phoneRegex.test(phone)) {
          showError(
            "è«‹è¼¸å…¥æ­£ç¢ºçš„æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ï¼ˆ09xxxxxxxxï¼‰",
            "phoneError",
            "passengerPhone"
          )
          return false
        }
        clearError("phoneError", "passengerPhone")
        return true
      }

      function validateDate() {
        const date = document.getElementById("reservationDate").value
        if (!date) {
          showError("è«‹é¸æ“‡é ç´„æ—¥æœŸ", "dateError", "reservationDate")
          return false
        }
        const selectedDate = new Date(date)
        const today = new Date()
        today.setHours(0, 0, 0, 0)
        if (selectedDate < today) {
          showError("é ç´„æ—¥æœŸä¸èƒ½æ—©æ–¼ä»Šå¤©", "dateError", "reservationDate")
          return false
        }
        clearError("dateError", "reservationDate")
        return true
      }

      function validateTime() {
        const hour = document.getElementById("reservationHour").value
        const minute = document.getElementById("reservationMinute").value
        if (!hour || !minute) {
          showError("è«‹é¸æ“‡é ç´„æ™‚é–“", "timeError")
          return false
        }
        clearError("timeError")
        return true
      }

      function validateStops() {
        let valid = true

        const keepStopName = document
          .getElementById("keepStopDisplayText")
          .textContent.trim()
        const destStopName = document
          .getElementById("destStopDisplayText")
          .textContent.trim()

        if (!keepStopName || keepStopName === "é»æ“Šé¸æ“‡ä¹˜è»Šç«™ç‰Œ") {
          showError("è«‹é¸æ“‡ä¹˜è»Šç«™ç‰Œ", "keepStopError", "keepStopDisplay")
          valid = false
        } else {
          clearError("keepStopError", "keepStopDisplay")
        }

        if (!destStopName || destStopName === "é»æ“Šé¸æ“‡ä¸‹è»Šç«™ç‰Œ") {
          showError("è«‹é¸æ“‡ä¸‹è»Šç«™ç‰Œ", "destStopError", "destStopDisplay")
          valid = false
        } else {
          clearError("destStopError", "destStopDisplay")
        }

        if (keepStopName && destStopName && keepStopName === destStopName) {
          showError(
            "ä¸Šè»Šç«™ç‰Œèˆ‡ä¸‹è»Šç«™ç‰Œä¸èƒ½ç›¸åŒ",
            "destStopError",
            "destStopDisplay"
          )
          valid = false
        } else {
          clearError("destStopError", "destStopDisplay")
        }

        return valid
      }

      // æ›´æ–°é ç´„æ‘˜è¦
      function updateSummary() {
        const name = document.getElementById("passengerName").value.trim()
        const title = (
          document.getElementById("passengerTitle")?.value || ""
        ).trim()
        const phone = document.getElementById("passengerPhone").value.trim()
        const keepStopName = document
          .getElementById("keepStopDisplayText")
          .textContent.trim()
        const destStopName = document
          .getElementById("destStopDisplayText")
          .textContent.trim()

        // æ›´æ–°æ‘˜è¦é¡¯ç¤º
        document.getElementById("summaryKeepStop").textContent =
          keepStopName && keepStopName !== "é»æ“Šé¸æ“‡ä¹˜è»Šç«™ç‰Œ"
            ? keepStopName
            : "-"
        document.getElementById("summaryDestStop").textContent =
          destStopName && destStopName !== "é»æ“Šé¸æ“‡ä¸‹è»Šç«™ç‰Œ"
            ? destStopName
            : "-"
        const combinedName = name ? `${name}${title}` : ""
        document.getElementById("summaryName").textContent = combinedName || "-"
        document.getElementById("summaryPhone").textContent = phone || "-"
        document.getElementById("summarySeatCount").textContent = seatCount

        // é¡¯ç¤ºç•¶å‰æ™‚é–“
        document.getElementById("summaryDateTime").textContent =
          getCurrentDateTime()

        // é¡¯ç¤ºæˆ–éš±è—æ‘˜è¦
        const hasBasicInfo =
          keepStopName &&
          keepStopName !== "é»æ“Šé¸æ“‡ä¹˜è»Šç«™ç‰Œ" &&
          destStopName &&
          destStopName !== "é»æ“Šé¸æ“‡ä¸‹è»Šç«™ç‰Œ" &&
          name &&
          phone
        if (hasBasicInfo) {
          document
            .getElementById("reservationSummary")
            .classList.remove("hidden")
        } else {
          document.getElementById("reservationSummary").classList.add("hidden")
        }
      }

      // è¡¨å–®æäº¤è™•ç†
      async function handleFormSubmit(e) {
        e.preventDefault()

        // é©—è­‰æ‰€æœ‰æ¬„ä½
        const isNameValid = validateName()
        const isPhoneValid = validatePhone()
        const isStopsValid = validateStops()

        if (!isNameValid || !isPhoneValid || !isStopsValid) {
          showError("è«‹å¡«å¯«æ‰€æœ‰å¿…è¦æ¬„ä½ä¸¦ç¢ºèªè³‡è¨Šæ­£ç¢º")
          return
        }

        if (!currentUser) {
          showError("ç”¨æˆ¶è³‡è¨Šè¼‰å…¥å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢")
          return
        }

        try {
          showLoading(true)
          const submitBtn = document.getElementById("submitBtn")
          submitBtn.disabled = true

          // æº–å‚™æäº¤è³‡æ–™
          const keepStopName = document
            .getElementById("keepStopDisplayText")
            .textContent.trim()
          const destStopName = document
            .getElementById("destStopDisplayText")
            .textContent.trim()

          const formData = {
            userId: currentUser.userId,
            keepStop: keepStopName,
            destStop: destStopName,
            name: (function () {
              const base = document.getElementById("passengerName").value.trim()
              const title = (
                document.getElementById("passengerTitle")?.value || ""
              ).trim()
              return title ? `${base}${title}` : base
            })(),
            phone: document.getElementById("passengerPhone").value.trim(),
            requestDateTime: getCurrentDateTime(),
            seatCount: seatCount,
          }

          console.log("æäº¤é ç´„è³‡æ–™:", formData)

          // ç™¼é€è«‹æ±‚
          const response = await fetch(`${API_BASE_URL}/request`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(formData),
          })

          let result = null
          try {
            result = await response.json()
          } catch (parseError) {
            // å¦‚æœä¸æ˜¯JSONæ ¼å¼ï¼Œå˜—è©¦è®€å–æ–‡å­—å…§å®¹
            console.warn("å›æ‡‰ä¸æ˜¯JSONæ ¼å¼:", parseError)
            const textResult = await response.text()
            result = { message: textResult }
          }

          if (response.ok) {
            // æˆåŠŸ
            showSuccessAnimation()
            setTimeout(() => {
              if (liff && liff.isInClient()) {
                liff.closeWindow()
              }
            }, 3000)
          } else {
            // å¤±æ•— - æª¢æŸ¥æ˜¯å¦ç‚ºé ç´„è¡çª
            const errorMessage = result.message || result || "é ç´„å¤±æ•—"
            if (
              errorMessage.includes("æœªæ­ä¹˜") ||
              errorMessage.includes("å·²æœ‰é ç´„")
            ) {
              // æœ‰ç¾æœ‰é ç´„ï¼Œé‡æ–°æª¢æŸ¥é ç´„ç‹€æ…‹
              await checkExistingReservation()
              showError("æ‚¨å·²æœ‰æœªå®Œæˆçš„é ç´„ï¼Œè«‹å…ˆè™•ç†ç¾æœ‰é ç´„")
            } else {
              showError(errorMessage)
            }
          }
        } catch (error) {
          console.error("æäº¤é ç´„å¤±æ•—:", error)
          showError("ç¶²è·¯éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦")
        } finally {
          showLoading(false)
          document.getElementById("submitBtn").disabled = false
        }
      }

      // é‡ç½®è¡¨å–®
      function resetForm() {
        document.getElementById("reservationForm").reset()
        document.getElementById("keepStopDisplay").textContent =
          "è«‹é¸æ“‡ä¸Šè»Šç«™ç‰Œ"
        document.getElementById("destStopDisplay").textContent =
          "è«‹é¸æ“‡ä¸‹è»Šç«™ç‰Œ"
        const titleEl = document.getElementById("passengerTitle")
        if (titleEl) titleEl.selectedIndex = 0
        seatCount = 1
        updateSeatDisplay()
        updateSummary()
      }

      // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      function showError(message, errorId = null, inputId = null) {
        if (errorId) {
          const errorElement = document.getElementById(errorId)
          errorElement.textContent = message
          errorElement.classList.add("show")
        } else {
          alert(message)
        }

        if (inputId) {
          document.getElementById(inputId).classList.add("input-error")
        }
      }

      // æ¸…é™¤éŒ¯èª¤è¨Šæ¯
      function clearError(errorId, inputId) {
        const errorElement = document.getElementById(errorId)
        errorElement.classList.remove("show")
        if (inputId) {
          document.getElementById(inputId).classList.remove("input-error")
        }
      }

      // é¡¯ç¤ºæˆåŠŸå‹•ç•«
      function showSuccessAnimation() {
        document.getElementById("successAnimation").classList.remove("hidden")
      }

      // é¡¯ç¤ºå–æ¶ˆæˆåŠŸå‹•ç•«
      function showCancelSuccessAnimation() {
        document
          .getElementById("cancelSuccessAnimation")
          .classList.remove("hidden")
      }

      // è‡ªè¨‚ç¢ºèªå°è©±æ–¹å¡Š
      function showConfirm(message) {
        return new Promise((resolve) => {
          const overlay = document.getElementById("confirmOverlay")
          const messageElement = document.getElementById("confirmMessage")
          const cancelBtn = document.getElementById("confirmCancel")
          const okBtn = document.getElementById("confirmOk")

          messageElement.textContent = message
          overlay.classList.remove("hidden")

          const handleResult = (result) => {
            overlay.classList.add("hidden")
            cancelBtn.removeEventListener("click", handleCancel)
            okBtn.removeEventListener("click", handleOk)
            resolve(result)
          }

          const handleCancel = () => handleResult(false)
          const handleOk = () => handleResult(true)

          cancelBtn.addEventListener("click", handleCancel)
          okBtn.addEventListener("click", handleOk)
        })
      }

      // é¡¯ç¤º/éš±è—è¼‰å…¥ä¸­
      function showLoading(show) {
        const loadingElement = document.getElementById("loadingMessage")
        if (show) {
          loadingElement.classList.add("show")
        } else {
          loadingElement.classList.remove("show")
        }
      }

      // åˆå§‹åŒ–åº§ä½é¡¯ç¤º
      updateSeatDisplay()
    </script>

    <!-- ç«™ç‰Œé¸å–å…¨é è¦–çª— -->
    <div id="stopModal" class="stop-modal" style="display: none">
      <div class="stop-modal-content">
        <div class="stop-modal-header">
          <h2>é¸æ“‡ç«™ç‰Œ</h2>
          <button class="stop-modal-close">âœ•</button>
        </div>
        <div class="stop-modal-body">
          <div class="route-legend" id="routeLegend">
            <div class="legend-title">è·¯ç·šé¡è‰²èªªæ˜</div>
            <div class="legend-items">
              <!-- åœ–ä¾‹é …ç›®å°‡å‹•æ…‹è¼‰å…¥é€™è£¡ -->
            </div>
          </div>
          <div class="stop-grid">
            <!-- ç«™ç‰Œå°‡å‹•æ…‹è¼‰å…¥é€™è£¡ -->
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
